##3.3 Control控制器
Control是HTTP模块，它可以通过HTTP协议从外部控制rtmp模块。通过Control控制器我们可以操作Record,Drop,Redirect三个命令来实现我们的业务场景

我们要做的仅仅是将以下location添加到http server标签中,如图3-3所示，我们在server linten80的标签下增加了一个control。
```
 location /control{
             rtmp_control all;
         }  
```
![](/assets/微信截图_20180125111655.png)
图3-3
####1.Record
通过Record选项，我们可以实现对直播流的录制与停止功能。这完全取决于我们在record中设置的参数。
我们先来看一个最简单的配置实现录制
     
```
application mylive{
           live on;
           hls on;
           hls_path /usr/local/m3u8File;
           hls_fragment 2s;
           hls_playlist_length 16s;
           recorder myRecord {
               record all manual;
               record_suffix _-%H-%M-%S.flv;
               record_path /tmp/rec;
           }
        }
        
```
首先手动去创建一个目录 mkdir /tmp/rec，再执行ffmpeg推流命令，再去请求开启录制的url
```
ffmpeg -i /tmp/nh.mp4 -c:v libx264 -c:a aac -f flv rtmp://172.26.22.30:1935/mylive/77 
#ffmpeg推流
http://172.26.22.30/control/record/start?app=mylive&name=77&rec=myRecord
#开启录制url
```






