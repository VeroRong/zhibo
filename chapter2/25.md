###2.5 你的第一个直播
>上一节我们搭建了nginx-rtmp-module环境，本节我们来搭建一个简单的直播

####1.进入配置文件目录
```
cd /usr/local/nginx/conf/
```
![](/assets/微信截图_20180122155958.png)
####2.修改默认配置文件
```
cd /etc/init.d/
vim nginx
```
修改文件中nginx.conf为live.conf
>NGINX_CONF_FILE="/usr/local/nginx/conf/live.conf" 


![](/assets/微信截图_20180122160811.png)
```
rename nginx live nginx.conf 
#修改nginx为live目标文件nginx.conf
```

####3.精简及确认live.conf
修改文件名后，我们将系统产生的配置文件进行精简并检查结果

```
worker_processes  1;
events {
    worker_connections  1024;
}
http {
    include       mime.types;
    default_type  application/octet-stream;
    sendfile        on;
    keepalive_timeout  65;
    server {
        listen       80;
        server_name  localhost;
        location / {
            root   html;
            index  index.html index.htm;
        }
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
   }
}
service nginx configtest
#nginx: the configuration file /usr/local/nginx/conf/live.conf syntax is ok
#nginx: configuration file /usr/local/nginx/conf/live.conf test is successful
```
####4. 配置RTMP直播
```
worker_processes  1;
events {
    worker_connections  1024;
}
rtmp{
   server{
       listen 1935;
       application mylive{
           live on;
       }
   }
}
http {
    include       mime.types;
    default_type  application/octet-stream;
    sendfile        on;
    keepalive_timeout  65;
    server {
        listen       80;
        server_name  localhost;
        location / {
            root   html;
            index  index.html index.htm;
        }
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
   }
}

```
####5. 防火墙规则
```
vim /etc/sysconfig/iptables

# Firewall configuration written by system-config-firewall
# Manual customization of this file is not recommended.
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
-A INPUT -p icmp -j ACCEPT
-A INPUT -i lo -j ACCEPT
-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT
-A INPUT -m state --state NEW -m tcp -p tcp --dport 21 -j ACCEPT
-A INPUT -p tcp --dport 1935 -j ACCEPT #开启tcp的1935端口写入权限
-A INPUT -j REJECT --reject-with icmp-host-prohibited
-A FORWARD -j REJECT --reject-with icmp-host-prohibited
COMMIT

```
>rtmp是基于tcp的实现

```
service iptables restart
```
>重启防火墙生效配置

![](/assets/微信截图_20180122164821.png)
####6. 推流
```
ffmpeg -i f:\xx.flv -f flv rtmp://127.0.0.1:1935/mylive/6
``` 
![](/assets/微信截图_20180122165156.png)
>ffmpeg于推拉流在之后的文章中说明
####7.拉流
